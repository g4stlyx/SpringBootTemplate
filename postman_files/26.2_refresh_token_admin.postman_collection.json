{
	"info": {
		"_postman_id": "refresh-token-admin-endpoints",
		"name": "26.2. Refresh Token - Admin Endpoints",
		"description": "Admin endpoints for managing and monitoring refresh tokens. Requires admin level 0 authorization.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Get All Refresh Tokens",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens"]
				},
				"description": "Get all refresh tokens in the system.\n\n**Authorization**: Admin level 0\n\n**Returns**: Array of all refresh tokens with user information."
			},
			"response": []
		},
		{
			"name": "2. Get Refresh Tokens (Filtered)",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens?userType=client&isRevoked=false",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens"],
					"query": [
						{
							"key": "userType",
							"value": "client",
							"description": "Filter by user type (client, coach, admin)"
						},
						{
							"key": "isRevoked",
							"value": "false",
							"description": "Filter by revocation status"
						},
						{
							"key": "userId",
							"value": "5",
							"description": "Filter by user ID",
							"disabled": true
						},
						{
							"key": "ipAddress",
							"value": "192.168.1.100",
							"description": "Filter by IP address",
							"disabled": true
						}
					]
				},
				"description": "Get filtered refresh tokens.\n\n**Query Parameters** (all optional):\n- `userType`: client, coach, admin\n- `userId`: specific user ID\n- `isRevoked`: true/false\n- `ipAddress`: specific IP address\n\n**Authorization**: Admin level 0"
			},
			"response": [
				{
					"name": "Success - Filtered Tokens",
					"originalRequest": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens?userType=client&isRevoked=false",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens"],
							"query": [
								{
									"key": "userType",
									"value": "client"
								},
								{
									"key": "isRevoked",
									"value": "false"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "[\n  {\n    \"id\": 1,\n    \"tokenPreview\": \"550e8400...\",\n    \"userId\": 5,\n    \"userType\": \"client\",\n    \"username\": \"testuser\",\n    \"expiryDate\": \"2026-03-15T10:30:00\",\n    \"createdAt\": \"2026-02-15T10:30:00\",\n    \"lastUsedAt\": \"2026-02-16T15:45:00\",\n    \"isRevoked\": false,\n    \"isExpired\": false,\n    \"deviceInfo\": \"Mozilla/5.0...\",\n    \"ipAddress\": \"192.168.1.100\"\n  }\n]"
				}
			]
		},
		{
			"name": "3. Get Refresh Token by ID",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/1",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens", "1"]
				},
				"description": "Get a specific refresh token by its ID.\n\n**Authorization**: Admin level 0\n\n**Returns**: Single refresh token details."
			},
			"response": [
				{
					"name": "Success - Token Details",
					"originalRequest": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/1",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens", "1"]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"id\": 1,\n  \"tokenPreview\": \"550e8400...\",\n  \"userId\": 5,\n  \"userType\": \"client\",\n  \"username\": \"testuser\",\n  \"expiryDate\": \"2026-03-15T10:30:00\",\n  \"createdAt\": \"2026-02-15T10:30:00\",\n  \"lastUsedAt\": \"2026-02-16T15:45:00\",\n  \"isRevoked\": false,\n  \"isExpired\": false,\n  \"deviceInfo\": \"Mozilla/5.0...\",\n  \"ipAddress\": \"192.168.1.100\"\n}"
				},
				{
					"name": "Error - Not Found",
					"originalRequest": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/999",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens", "999"]
						}
					},
					"status": "Not Found",
					"code": 404,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "\"Refresh token not found with ID: 999\""
				}
			]
		},
		{
			"name": "4. Get Active Tokens for User",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/user/5?userType=client",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens", "user", "5"],
					"query": [
						{
							"key": "userType",
							"value": "client",
							"description": "Required: client, coach, or admin"
						}
					]
				},
				"description": "Get all active (non-revoked, non-expired) tokens for a specific user.\n\n**Path Parameter**: userId\n\n**Query Parameter**: userType (required)\n\n**Authorization**: Admin level 0"
			},
			"response": []
		},
		{
			"name": "5. Get Token Statistics",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/stats",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens", "stats"]
				},
				"description": "Get statistics about refresh tokens in the system.\n\n**Returns**:\n- Total active tokens\n- Total tokens\n- Breakdown by user type\n\n**Authorization**: Admin level 0"
			},
			"response": [
				{
					"name": "Success - Token Stats",
					"originalRequest": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/stats",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens", "stats"]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"totalActiveTokens\": 150,\n  \"totalTokens\": 200,\n  \"activeTokensByUserType\": {\n    \"client\": 80,\n    \"coach\": 45,\n    \"admin\": 25\n  },\n  \"clientTokens\": 80,\n  \"coachTokens\": 45,\n  \"adminTokens\": 25\n}"
				}
			]
		},
		{
			"name": "6. Revoke Token by ID",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "PUT",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/1/revoke",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens", "1", "revoke"]
				},
				"description": "Revoke a specific refresh token by ID.\n\n**Action**: Sets isRevoked = true for the token.\n\n**Effect**: User will be logged out on next API call.\n\n**Authorization**: Admin level 0"
			},
			"response": [
				{
					"name": "Success - Token Revoked",
					"originalRequest": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/1/revoke",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens", "1", "revoke"]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"message\": \"Refresh token revoked successfully\"\n}"
				}
			]
		},
		{
			"name": "7. Revoke All User Tokens",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "PUT",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/revoke-all?userId=5&userType=client",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens", "revoke-all"],
					"query": [
						{
							"key": "userId",
							"value": "5",
							"description": "Required: User ID"
						},
						{
							"key": "userType",
							"value": "client",
							"description": "Required: client, coach, or admin"
						}
					]
				},
				"description": "Revoke ALL refresh tokens for a specific user.\n\n**Action**: Revokes all tokens for userId + userType.\n\n**Effect**: User will be logged out from all devices.\n\n**Authorization**: Admin level 0"
			},
			"response": [
				{
					"name": "Success - All Tokens Revoked",
					"originalRequest": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/revoke-all?userId=5&userType=client",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens", "revoke-all"],
							"query": [
								{
									"key": "userId",
									"value": "5"
								},
								{
									"key": "userType",
									"value": "client"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"message\": \"All tokens revoked for user\",\n  \"revokedCount\": 3\n}"
				}
			]
		},
		{
			"name": "8. Delete Token by ID",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "DELETE",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/1",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens", "1"]
				},
				"description": "Permanently delete a refresh token from the database.\n\n**Warning**: This is a permanent deletion. Use with caution.\n\n**Recommendation**: Use 'revoke' instead for most cases.\n\n**Authorization**: Admin level 0"
			},
			"response": [
				{
					"name": "Success - Token Deleted",
					"originalRequest": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/1",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens", "1"]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"message\": \"Refresh token deleted successfully\"\n}"
				}
			]
		},
		{
			"name": "9. Manual Cleanup",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{adminToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/cleanup",
					"host": ["{{baseUrl}}"],
					"path": ["api", "v1", "admin", "refresh-tokens", "cleanup"]
				},
				"description": "Manually trigger cleanup of expired and revoked tokens.\n\n**Automatic**: This also runs daily at 2:00 AM via scheduled task.\n\n**Action**: Deletes tokens that are:\n- Both revoked AND expired\n- Expired more than 7 days ago\n\n**Authorization**: Admin level 0"
			},
			"response": [
				{
					"name": "Success - Cleanup Complete",
					"originalRequest": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/refresh-tokens/cleanup",
							"host": ["{{baseUrl}}"],
							"path": ["api", "v1", "admin", "refresh-tokens", "cleanup"]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"message\": \"Token cleanup completed\",\n  \"tokensRemoved\": 45\n}"
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "adminToken",
			"value": "",
			"type": "string",
			"description": "Admin level 0 access token"
		}
	]
}
